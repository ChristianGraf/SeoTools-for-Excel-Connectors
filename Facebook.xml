<?xml version="1.0" encoding="utf-8" ?>
<Suite Title="Facebook" Id="Facebook" Category="Social" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/Facebook.xml" HelpUrl="http://seotoolsforexcel.com/facebook/" HelpText="Documentation">

  <Author Name="Niels Bosma" Url="https://se.linkedin.com/in/bosmaniels"/>

  <Settings HelpText="What's this?" HelpUrl="http://seotoolsforexcel.com/facebook/">
    <Text Id="AccessToken" Title="Access Token" Required="false" HelpUrl="http://seotoolsforexcel.com/facebook/"/>
  </Settings>

  <RestConnector Id="Page" Title="Page Lookup">
    <Parameters>
      <Text Id="Id" Title="Id or URL" DefaultValue="" Required="true"/>
    </Parameters>
    <Fetch Url="https://graph.facebook.com/?id=@(Model.Id)&amp;access_token=@(Model.AccessToken)">
      <HttpSettings>
        <IntervalBetweenRequests RandomFrom="0" RandomTo="0" IfSame="Host"/>
      </HttpSettings>
    </Fetch>
    <Parse>
      <JsonPath Title="Likes" Id="Likes" Expr="$.likes" Converter="Int" HelpText=""/>
      <JsonPath Title="Id" Id="Dd" Expr="$.id" Converter="String" HelpText="" Checked="false"/>
      <JsonPath Title="Checkins" Id="checkins" Expr="$.checkins" Converter="Int" HelpText="" Checked="false"/>
      <JsonPath Title="About" Id="About" Expr="$.about" Converter="String" HelpText="" Checked="false"/>
      <JsonPath Title="Link" Id="Link" Expr="$.link" Converter="String" HelpText="" Checked="false"/>
      <JsonPath Title="Name" Id="Name" Expr="$.name" Converter="String" HelpText="" Checked="false"/>
      <JsonPath Title="Website" Id="Website" Expr="$.website" Converter="String" HelpText="" Checked="false"/>
    </Parse>
    <Fail>
      <JsonPath Expr="$.error.message"/>
    </Fail>
  </RestConnector>
  
</Suite>