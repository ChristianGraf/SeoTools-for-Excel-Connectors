<?xml version="1.0" encoding="utf-8" ?>
<Suite RequireVersion="5.2.6" Title="FullContact" Id="FullContact" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/FullContact.xml" HelpUrl="http://seotoolsforexcel.com/fullcontact" HelpText="Documentation">

  <Author Name="Victor" Url="http://community.seotoolsforexcel.com/users/diskborste/activity"/>

  <Settings HelpText="What's this?" HelpUrl="http://seotoolsforexcel.com/fullcontact">
    <Text Id="Key" Title="API Key" Required="true"/>
  </Settings>

  <RestConnector Id="ContactLookupByEmail" Title="Email lookup">
    <Parameters>
      <Text Id="Email" Title="Email" Debug.DefaultValue="viktoria.isaksson@missioncouncil.se" Required="true"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
      <![CDATA[
      https://api.fullcontact.com/v2/person.json?
      email=@Utils.UrlEncode(Model.Email)
      &apiKey=@Model.Key
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="contactInfo.websites[*]">
        <JsonPath Expr="url" Id="url" Title="Urls" Converter="String"/>
      </JsonPath>
      <JsonPath Expr="contactInfo.fullName" Id="fullname" Title="FullName" Converter="String"/>
      <JsonPath Expr="organizations[*]">
        <JsonPath Expr="name" Id="organizationsname" Title="OrgName" Converter="String"/>
        <JsonPath Expr="startDate" Id="startDate" Title="OrgStartDate" Converter="DateTime"/>
        <JsonPath Expr="title" Id="title" Title="OrgTitle" Converter="String"/>
        <JsonPath Expr="current" Id="current" Title="CurrentStatus" Converter="String"/>
      </JsonPath>
      <JsonPath Expr="socialProfiles[?(@@.typeId=='linkedin')].url" Id="LinkedinUrl" Title="LinkedInUrl" Converter="String" />
      <JsonPath Expr="socialProfiles[?(@@.typeId=='twitter')].url" Id="TwitterUrl" Title="TwitterUrl" Converter="String" />
      <JsonPath Expr="socialProfiles[?(@@.typeId=='facebook')].url" Id="FacebookUrl" Title="FacebookUrl" Converter="String" />
      <JsonPath Expr="digitalFootprint.scores[?(@@.provider=='klout')].value" Id="KloutScore" Title="KloutScore" Converter="Int"/>
    </Parse>
  </RestConnector>

  <RestConnector Id="NameNormalizer" Title="Name normalizer" HelpText="Takes quasi-structured name data provided as a string and outputs the data in a structured manner.">
    <Parameters>
      <Text Id="Query" Title="Name" Debug.DefaultValue="mr john (johnny) michael smith jr mba" Required="true"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
      <![CDATA[
      https://api.fullcontact.com/v2/name/normalizer.json?
      q=@Utils.UrlEncode(Model.Query)
      &apiKey=@Model.Key
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="nameDetails.fullName" Id="nameDetails.fullName" Title="FullName" Converter="String"/>
      <JsonPath Expr="nameDetails.givenName" Id="nameDetails.givenName" Title="GivenName" Converter="String"/>
      <JsonPath Expr="nameDetails.familyName" Id="nameDetails.familyName" Title="FamilyName" Converter="String"/>
      <JsonPath Expr="nameDetails.middleNames[*]">
        <JsonPath Expr="$" Id="middleNames" Title="MiddleNames" Converter="String"/>
      </JsonPath>
      <JsonPath Expr="nameDetails.prefixes[*]">
        <JsonPath Expr="$" Id="prefixes" Title="Prefixes" Converter="String"/>
      </JsonPath>
      <JsonPath Expr="nameDetails.suffixes[*]">
        <JsonPath Expr="$" Id="suffixes" Title="Suffixes" Converter="String"/>
      </JsonPath>
      <JsonPath Expr="nameDetails.nicknames[*]">
        <JsonPath Expr="$" Id="nicknames" Title="NickNames" Converter="String"/>
      </JsonPath>
      <JsonPath Expr="likelihood" Id="likelihood" Title="Likelihood" Converter="Double"/>
    </Parse>
  </RestConnector>

  <RestConnector Id="EmailDeducer" Title="Email deducer" HelpText="Takes an email address provided as a string and attempts to deduce a structured name.">
    <Parameters>
      <Text Id="Email" Title="Email" Debug.DefaultValue="johndsmith79@business.com" Required="true"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
      <![CDATA[
      https://api.fullcontact.com/v2/name/deducer.json?
		  email=@Utils.UrlEncode(Model.Email)
		  &apiKey=@Model.Key
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="nameDetails.fullName" Id="nameDetails.fullName" Title="FullName" Converter="String"/>
      <JsonPath Expr="nameDetails.givenName" Id="nameDetails.givenName" Title="GivenName" Converter="String"/>
      <JsonPath Expr="nameDetails.familyName" Id="nameDetails.familyName" Title="FamilyName" Converter="String"/>
      <JsonPath Expr="nameDetails.middleNames[*]">
        <JsonPath Expr="$" Id="middleNames" Title="MiddleNames" Converter="String"/>
      </JsonPath>
      <JsonPath Expr="likelihood" Id="likelihood" Title="Likelihood" Converter="Double"/>
    </Parse>
  </RestConnector>

  <RestConnector Id="UsernameDeducer" Title="Username deducer" HelpText="Takes a username provided as a string and attempts to deduce a structured name.">
    <Parameters>
      <Text Id="Username" Title="Name" Debug.DefaultValue="johndsmith79" Required="true"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
      <![CDATA[
      https://api.fullcontact.com/v2/name/deducer.json?
		  username=@Utils.UrlEncode(Model.Username)
		  &apiKey=@Model.Key
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="nameDetails.fullName" Id="nameDetails.fullName" Title="FullName" Converter="String"/>
      <JsonPath Expr="nameDetails.givenName" Id="nameDetails.givenName" Title="GivenName" Converter="String"/>
      <JsonPath Expr="nameDetails.familyName" Id="nameDetails.familyName" Title="FamilyName" Converter="String"/>
      <JsonPath Expr="nameDetails.middleNames[*]">
        <JsonPath Expr="$" Id="middleNames" Title="MiddleNames" Converter="String"/>
      </JsonPath>
      <JsonPath Expr="likelihood" Id="likelihood" Title="Likelihood" Converter="Double"/>
    </Parse>
  </RestConnector>

  <RestConnector Id="DomainLookup" Title="Domain lookup">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="aftonbladet.se" Required="true"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
      <![CDATA[
      https://api.fullcontact.com/v2/company/lookup.json?
      domain=@Utils.UrlEncode(Model.Domain)
      &apiKey=@Model.Key
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="organization.name" Id="name" Title="OrgName" Converter="String"/>
      <JsonPath Expr="traffic.ranking[?(@@.locale=='global')].rank" Id="GlobalRank" Title="GlobalRanking" Converter="Int" />
      <JsonPath Expr="organization.contactInfo.emailAddresses[*]">
        <JsonPath Expr="value" Id="value" Title="ContactEmail" Converter="String"/>
      </JsonPath>
      <JsonPath Expr="organization.contactInfo.phoneNumbers[*]">
        <JsonPath Expr="number" Id="number" Title="ContactPhone" Converter="String"/>
      </JsonPath>
      <JsonPath Expr="organization.keywords[*]">
        <JsonPath Expr="$" Id="keywords" Title="Keywords" Converter="String"/>
      </JsonPath>
      <JsonPath Expr="socialProfiles[?(@@.typeId=='twitter')].url" Id="TwitterUrl" Title="TwitterUrl" Converter="String" />
      <JsonPath Expr="socialProfiles[?(@@.typeId=='facebook')].url" Id="FacebookUrl" Title="FacebookUrl" Converter="String" />
    </Parse>
  </RestConnector>

</Suite>